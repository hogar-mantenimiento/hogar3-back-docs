"use strict";(globalThis.webpackChunkhogar_3_back_docs=globalThis.webpackChunkhogar_3_back_docs||[]).push([[8962],{6033:(e,o,s)=>{s.r(o),s.d(o,{assets:()=>a,contentTitle:()=>d,default:()=>u,frontMatter:()=>t,metadata:()=>r,toc:()=>i});const r=JSON.parse('{"id":"Protocolos/crear-modulo","title":"Crear un M\xf3dulo","description":"La creaci\xf3n de un m\xf3dulo conlleva varios pasos que involucran el uso de decoradores customizados, los cuales son parte del flujo de creaci\xf3n de un m\xf3dulo y no fueron listados en la secci\xf3n de Decoradores generales.","source":"@site/docs/Protocolos/crear-modulo.md","sourceDirName":"Protocolos","slug":"/Protocolos/crear-modulo","permalink":"/hogar3-back-docs/docs/Protocolos/crear-modulo","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/Protocolos/crear-modulo.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1},"sidebar":"tutorialSidebar","previous":{"title":"Procesos o pasos de desarrollo","permalink":"/hogar3-back-docs/docs/category/procesos-o-pasos-de-desarrollo"},"next":{"title":"Crear Proceso Intermodular","permalink":"/hogar3-back-docs/docs/Protocolos/crear-proceso-intermodular"}}');var n=s(4848),l=s(8453);const t={sidebar_position:1},d="Crear un M\xf3dulo",a={},i=[{value:"Paso 1: Crear el M\xf3dulo Base",id:"paso-1-crear-el-m\xf3dulo-base",level:3},{value:"Paso 2: Setear los Permisos (<code>@PermissionsRef</code>)",id:"paso-2-setear-los-permisos-permissionsref",level:3},{value:"Ejemplo",id:"ejemplo",level:4},{value:"Paso 3: Definir Contexto de los Controllers (<code>@ModuleContext</code>)",id:"paso-3-definir-contexto-de-los-controllers-modulecontext",level:3},{value:"Ejemplo",id:"ejemplo-1",level:4},{value:"Paso 4: Cargar a Historial (<code>@MetadataEntityUse</code>)",id:"paso-4-cargar-a-historial-metadataentityuse",level:3},{value:"Ejemplo",id:"ejemplo-2",level:4}];function c(e){const o={code:"code",em:"em",h1:"h1",h3:"h3",h4:"h4",header:"header",hr:"hr",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,l.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(o.header,{children:(0,n.jsx)(o.h1,{id:"crear-un-m\xf3dulo",children:"Crear un M\xf3dulo"})}),"\n",(0,n.jsx)(o.p,{children:"La creaci\xf3n de un m\xf3dulo conlleva varios pasos que involucran el uso de decoradores customizados, los cuales son parte del flujo de creaci\xf3n de un m\xf3dulo y no fueron listados en la secci\xf3n de Decoradores generales."}),"\n",(0,n.jsx)(o.hr,{}),"\n",(0,n.jsx)(o.h3,{id:"paso-1-crear-el-m\xf3dulo-base",children:"Paso 1: Crear el M\xf3dulo Base"}),"\n",(0,n.jsx)(o.p,{children:"La parte m\xe1s sencilla del proceso. Se crea primero un m\xf3dulo nativo de NestJS utilizando el comando CLI:"}),"\n",(0,n.jsx)(o.pre,{children:(0,n.jsx)(o.code,{className:"language-bash",children:"nest g res modulo-name\n"})}),"\n",(0,n.jsx)(o.hr,{}),"\n",(0,n.jsxs)(o.h3,{id:"paso-2-setear-los-permisos-permissionsref",children:["Paso 2: Setear los Permisos (",(0,n.jsx)(o.code,{children:"@PermissionsRef"}),")"]}),"\n",(0,n.jsxs)(o.p,{children:["Es necesario asignar qu\xe9 ",(0,n.jsx)(o.strong,{children:"permisos"})," ser\xe1n visibles y administrables para el administrador del ",(0,n.jsx)(o.em,{children:"profiler"})," para que el m\xf3dulo pueda ser utilizado."]}),"\n",(0,n.jsxs)(o.p,{children:["Esto se logra usando el decorador ",(0,n.jsx)(o.strong,{children:(0,n.jsx)(o.code,{children:"@PermissionsRef()"})}),", el cual se aplica a la clase principal del m\xf3dulo. Dentro de ",(0,n.jsx)(o.code,{children:"@PermissionsRef"}),", se listan todos los permisos asociados. Si se necesitan m\xe1s permisos, deben agregarse al ",(0,n.jsx)(o.em,{children:"enum"})," ",(0,n.jsx)(o.code,{children:"common/interfaces/permisos.ts"}),"."]}),"\n",(0,n.jsx)(o.h4,{id:"ejemplo",children:"Ejemplo"}),"\n",(0,n.jsx)(o.pre,{children:(0,n.jsx)(o.code,{className:"language-typescript",children:"import { Permisos } from 'common/interfaces/permisos.ts';\n\n@PermissionRef(\n  Permisos.USUARIO_LISTAR,\n  Permisos.USUARIO_ELIMINAR,\n  Permisos.USUARIO_EDITAR,\n)\n@Module({\n    // configuraci\xf3n del m\xf3dulo\n})\nexport class ModuloCreado {}\n"})}),"\n",(0,n.jsx)(o.hr,{}),"\n",(0,n.jsxs)(o.h3,{id:"paso-3-definir-contexto-de-los-controllers-modulecontext",children:["Paso 3: Definir Contexto de los Controllers (",(0,n.jsx)(o.code,{children:"@ModuleContext"}),")"]}),"\n",(0,n.jsxs)(o.p,{children:["Se agrega el decorador ",(0,n.jsx)(o.strong,{children:(0,n.jsx)(o.code,{children:"@ModuleContext()"})})," al o los ",(0,n.jsx)(o.em,{children:"controllers"})," del m\xf3dulo."]}),"\n",(0,n.jsxs)(o.p,{children:["Este decorador es crucial, ya que define ",(0,n.jsx)(o.strong,{children:"a qu\xe9 m\xf3dulo pertenece"})," el ",(0,n.jsx)(o.em,{children:"controller"}),"."]}),"\n",(0,n.jsxs)(o.p,{children:["Si ",(0,n.jsx)(o.strong,{children:(0,n.jsx)(o.code,{children:"@ModuleContext"})})," est\xe1 presente, este ",(0,n.jsxs)(o.strong,{children:["bloquea los ",(0,n.jsx)(o.em,{children:"endpoints"})]})," seg\xfan si el usuario tiene o no ese m\xf3dulo activo en su ",(0,n.jsx)(o.em,{children:"profiler"}),". Internamente, ",(0,n.jsx)(o.code,{children:"@Auth()"})," se encarga de validar este contexto. Si ",(0,n.jsx)(o.code,{children:"@ModuleContext"})," no se encuentra, el m\xf3dulo se considera activo por defecto para todos los usuarios."]}),"\n",(0,n.jsxs)(o.p,{children:[(0,n.jsx)(o.code,{children:"@ModuleContext()"})," acepta dos modos de usarse:"]}),"\n",(0,n.jsxs)(o.table,{children:[(0,n.jsx)(o.thead,{children:(0,n.jsxs)(o.tr,{children:[(0,n.jsx)(o.th,{style:{textAlign:"left"},children:"Modo de Uso"}),(0,n.jsx)(o.th,{style:{textAlign:"left"},children:"Descripci\xf3n"}),(0,n.jsx)(o.th,{style:{textAlign:"left"},children:"Recomendaci\xf3n"})]})}),(0,n.jsxs)(o.tbody,{children:[(0,n.jsxs)(o.tr,{children:[(0,n.jsx)(o.td,{style:{textAlign:"left"},children:(0,n.jsx)(o.strong,{children:(0,n.jsx)(o.code,{children:"@ModuleContext(str: string)"})})}),(0,n.jsxs)(o.td,{style:{textAlign:"left"},children:["Un ",(0,n.jsx)(o.em,{children:"string"})," que establece el nombre del m\xf3dulo. Se recomienda usar una ",(0,n.jsx)(o.strong,{children:"constante global"})," para evitar errores tipogr\xe1ficos (ej. ",(0,n.jsx)(o.code,{children:"AUTH_MOD_FLAG"}),")."]}),(0,n.jsx)(o.td,{style:{textAlign:"left"},children:(0,n.jsx)(o.strong,{children:"Recomendado"})})]}),(0,n.jsxs)(o.tr,{children:[(0,n.jsx)(o.td,{style:{textAlign:"left"},children:(0,n.jsx)(o.strong,{children:(0,n.jsx)(o.code,{children:"@ModuleContext(() => Module)"})})}),(0,n.jsx)(o.td,{style:{textAlign:"left"},children:"Se le carga el m\xf3dulo padre. Este m\xe9todo puede fallar a veces al no encontrar la referencia directa."}),(0,n.jsx)(o.td,{style:{textAlign:"left"},children:(0,n.jsx)(o.strong,{children:"Evitar"})})]})]})]}),"\n",(0,n.jsx)(o.h4,{id:"ejemplo-1",children:"Ejemplo"}),"\n",(0,n.jsx)(o.pre,{children:(0,n.jsx)(o.code,{className:"language-typescript",metastring:'title="users.controller.ts"',children:"import { AUTH_MOD_FLAG } from 'common/constants';\n\n@ModuleContext(AUTH_MOD_FLAG)\n@Controller('users')\nexport class UsersController {\n    // ...\n}\n"})}),"\n",(0,n.jsx)(o.hr,{}),"\n",(0,n.jsxs)(o.h3,{id:"paso-4-cargar-a-historial-metadataentityuse",children:["Paso 4: Cargar a Historial (",(0,n.jsx)(o.code,{children:"@MetadataEntityUse"}),")"]}),"\n",(0,n.jsx)(o.p,{children:(0,n.jsx)(o.strong,{children:"(Opcional y sujeto a posible eliminaci\xf3n)"})}),"\n",(0,n.jsx)(o.p,{children:"Se puede registrar en un historial los cambios que suceden a una entidad concreta."}),"\n",(0,n.jsxs)(o.p,{children:["Esto se logra agregando el decorador ",(0,n.jsx)(o.strong,{children:(0,n.jsx)(o.code,{children:"@MetadataEntityUse(Entity)"})})," al ",(0,n.jsx)(o.em,{children:"controller"}),". ",(0,n.jsx)(o.code,{children:"Entity"})," debe ser la entidad principal que se maneja desde ese ",(0,n.jsx)(o.em,{children:"controller"})," en concreto."]}),"\n",(0,n.jsx)(o.h4,{id:"ejemplo-2",children:"Ejemplo"}),"\n",(0,n.jsx)(o.pre,{children:(0,n.jsx)(o.code,{className:"language-typescript",metastring:'title="products.controller.ts"',children:"import { ProductEntity } from 'products/entities/product.entity';\n\n@MetadataEntityUse(ProductEntity)\n@Controller('products')\nexport class ProductsController {\n    // ...\n}\n"})})]})}function u(e={}){const{wrapper:o}={...(0,l.R)(),...e.components};return o?(0,n.jsx)(o,{...e,children:(0,n.jsx)(c,{...e})}):c(e)}},8453:(e,o,s)=>{s.d(o,{R:()=>t,x:()=>d});var r=s(6540);const n={},l=r.createContext(n);function t(e){const o=r.useContext(l);return r.useMemo(function(){return"function"==typeof e?e(o):{...o,...e}},[o,e])}function d(e){let o;return o=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:t(e.components),r.createElement(l.Provider,{value:o},e.children)}}}]);